{
  "hash": "dfcba56a81822c05af48dd5576dae523",
  "result": {
    "markdown": "---\ntitle: \"군집분석\"\ndate: \"2023/12/05\"\nauthor: \"Sungil Park\"\ndescription: \"2023-2학기 R로 하는 금융데이터분석\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprotein <- read.csv(\"contents/protein.csv\",header=TRUE)\n\nhead(protein)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         country   x1   x2  x3   x4  x5   x6  x7  x8  x9\n1        Albania 10.1  1.4 0.5  8.9 0.2 42.3 0.6 5.5 1.7\n2        Austria  8.9 14.0 4.3 19.9 2.1 28.0 3.6 1.3 4.3\n3        Belgium 13.5  9.3 4.1 17.5 4.5 26.6 5.7 2.1 4.0\n4       Bulgaria  7.8  6.0 1.6  8.3 1.2 56.7 1.1 3.7 4.2\n5 Czechoslovakia  9.7 11.4 2.8 12.5 2.0 34.3 5.0 1.1 4.0\n6        Denmark 10.6 10.8 3.7 25.0 9.9 21.9 4.8 0.7 2.4\n```\n:::\n\n```{.r .cell-code}\n# x1 - red meat / x2 - white meat / x3 - eggs / x4 - milk\n# x5 - fish / x6 - cereal / x7 - starch(탄수화물 bread로 해석) / x8 - nuts / x9 - fruits & vegetables\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 예 7.1 \nprotein.X <- cbind(protein[1],scale(protein[-1],center=TRUE,scale=TRUE))   # ① 표준화\nsummary(protein.X)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   country                x1                x2                 x3          \n Length:25          Min.   :-1.6217   Min.   :-1.75849   Min.   :-2.17964  \n Class :character   1st Qu.:-0.6059   1st Qu.:-0.81103   1st Qu.:-0.21116  \n Mode  :character   Median :-0.0980   Median :-0.02599   Median :-0.03221  \n                    Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.00000  \n                    3rd Qu.: 0.2306   3rd Qu.: 0.78612   3rd Qu.: 0.68360  \n                    Max.   : 2.4415   Max.   : 1.65237   Max.   : 1.57836  \n       x4                x5                x6                x7         \n Min.   :-1.5825   Min.   :-1.2003   Min.   :-1.2436   Min.   :-2.2496  \n 1st Qu.:-0.9011   1st Qu.:-0.6419   1st Qu.:-0.7242   1st Qu.:-0.7197  \n Median : 0.1619   Median :-0.2598   Median :-0.3871   Median : 0.2595  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.: 0.5844   3rd Qu.: 0.4456   3rd Qu.: 0.7155   3rd Qu.: 0.8714  \n Max.   : 2.3697   Max.   : 2.9143   Max.   : 2.2280   Max.   : 1.3610  \n       x8                x9         \n Min.   :-1.1946   Min.   :-1.5167  \n 1st Qu.:-0.7917   1st Qu.:-0.6852  \n Median :-0.3384   Median :-0.1863  \n Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.: 0.8199   3rd Qu.: 0.4235  \n Max.   : 2.3810   Max.   : 2.0866  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprotein\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          country   x1   x2  x3   x4   x5   x6  x7  x8  x9\n1         Albania 10.1  1.4 0.5  8.9  0.2 42.3 0.6 5.5 1.7\n2         Austria  8.9 14.0 4.3 19.9  2.1 28.0 3.6 1.3 4.3\n3         Belgium 13.5  9.3 4.1 17.5  4.5 26.6 5.7 2.1 4.0\n4        Bulgaria  7.8  6.0 1.6  8.3  1.2 56.7 1.1 3.7 4.2\n5  Czechoslovakia  9.7 11.4 2.8 12.5  2.0 34.3 5.0 1.1 4.0\n6         Denmark 10.6 10.8 3.7 25.0  9.9 21.9 4.8 0.7 2.4\n7       E Germany  8.4 11.6 3.7 11.1  5.4 24.6 6.5 0.8 3.6\n8         Finland  9.5  4.9 2.7 33.7  5.8 26.3 5.1 1.0 1.4\n9          France 18.0  9.9 3.3 19.5  5.7 28.1 4.8 2.4 6.5\n10         Greece 10.2  3.0 2.8 17.6  5.9 41.7 2.2 7.8 6.5\n11        Hungary  5.3 12.4 2.9  9.7  0.3 40.1 4.0 5.4 4.2\n12        Ireland 13.9 10.0 4.7 25.8  2.2 24.0 6.2 1.6 2.9\n13          Italy  9.0  5.1 2.9 13.7  3.4 36.8 2.1 4.3 6.7\n14    Netherlands  9.5 13.6 3.6 23.4  2.5 22.4 4.2 1.8 3.7\n15         Norway  9.4  4.7 2.7 23.3  9.7 23.0 4.6 1.6 2.7\n16         Poland  6.9 10.2 2.7 19.3  3.0 36.1 5.9 2.0 6.6\n17       Portugal  6.2  3.7 1.1  4.9 14.2 27.0 5.9 4.7 7.9\n18        Romania  6.2  6.3 1.5 11.1  1.0 49.6 3.1 5.3 2.8\n19          Spain  7.1  3.4 3.1  8.6  7.0 29.2 5.7 5.9 7.2\n20         Sweden  9.9  7.8 3.5  4.7  7.5 19.5 3.7 1.4 2.0\n21    Switzerland 13.1 10.1 3.1 23.8  2.3 25.6 2.8 2.4 4.9\n22             UK 17.4  5.7 4.7 20.6  4.3 24.3 4.7 3.4 3.3\n23           USSR  9.3  4.6 2.1 16.6  3.0 43.6 6.4 3.4 2.9\n24      W Germany 11.4 12.5 4.1 18.8  3.4 18.6 5.2 1.5 3.8\n25     Yugoslavia  4.4  5.0 1.2  9.5  0.6 55.9 3.0 5.7 3.2\n```\n:::\n\n```{.r .cell-code}\nprotein[-1]  # 첫번째 나라 이름 변수를 제외하는 옵션\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     x1   x2  x3   x4   x5   x6  x7  x8  x9\n1  10.1  1.4 0.5  8.9  0.2 42.3 0.6 5.5 1.7\n2   8.9 14.0 4.3 19.9  2.1 28.0 3.6 1.3 4.3\n3  13.5  9.3 4.1 17.5  4.5 26.6 5.7 2.1 4.0\n4   7.8  6.0 1.6  8.3  1.2 56.7 1.1 3.7 4.2\n5   9.7 11.4 2.8 12.5  2.0 34.3 5.0 1.1 4.0\n6  10.6 10.8 3.7 25.0  9.9 21.9 4.8 0.7 2.4\n7   8.4 11.6 3.7 11.1  5.4 24.6 6.5 0.8 3.6\n8   9.5  4.9 2.7 33.7  5.8 26.3 5.1 1.0 1.4\n9  18.0  9.9 3.3 19.5  5.7 28.1 4.8 2.4 6.5\n10 10.2  3.0 2.8 17.6  5.9 41.7 2.2 7.8 6.5\n11  5.3 12.4 2.9  9.7  0.3 40.1 4.0 5.4 4.2\n12 13.9 10.0 4.7 25.8  2.2 24.0 6.2 1.6 2.9\n13  9.0  5.1 2.9 13.7  3.4 36.8 2.1 4.3 6.7\n14  9.5 13.6 3.6 23.4  2.5 22.4 4.2 1.8 3.7\n15  9.4  4.7 2.7 23.3  9.7 23.0 4.6 1.6 2.7\n16  6.9 10.2 2.7 19.3  3.0 36.1 5.9 2.0 6.6\n17  6.2  3.7 1.1  4.9 14.2 27.0 5.9 4.7 7.9\n18  6.2  6.3 1.5 11.1  1.0 49.6 3.1 5.3 2.8\n19  7.1  3.4 3.1  8.6  7.0 29.2 5.7 5.9 7.2\n20  9.9  7.8 3.5  4.7  7.5 19.5 3.7 1.4 2.0\n21 13.1 10.1 3.1 23.8  2.3 25.6 2.8 2.4 4.9\n22 17.4  5.7 4.7 20.6  4.3 24.3 4.7 3.4 3.3\n23  9.3  4.6 2.1 16.6  3.0 43.6 6.4 3.4 2.9\n24 11.4 12.5 4.1 18.8  3.4 18.6 5.2 1.5 3.8\n25  4.4  5.0 1.2  9.5  0.6 55.9 3.0 5.7 3.2\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprotein.Z <- scale(protein[-1],center=TRUE,scale=TRUE)   # ① 표준화\nsummary(protein.Z)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       x1                x2                 x3                 x4         \n Min.   :-1.6217   Min.   :-1.75849   Min.   :-2.17964   Min.   :-1.5825  \n 1st Qu.:-0.6059   1st Qu.:-0.81103   1st Qu.:-0.21116   1st Qu.:-0.9011  \n Median :-0.0980   Median :-0.02599   Median :-0.03221   Median : 0.1619  \n Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000  \n 3rd Qu.: 0.2306   3rd Qu.: 0.78612   3rd Qu.: 0.68360   3rd Qu.: 0.5844  \n Max.   : 2.4415   Max.   : 1.65237   Max.   : 1.57836   Max.   : 2.3697  \n       x5                x6                x7                x8         \n Min.   :-1.2003   Min.   :-1.2436   Min.   :-2.2496   Min.   :-1.1946  \n 1st Qu.:-0.6419   1st Qu.:-0.7242   1st Qu.:-0.7197   1st Qu.:-0.7917  \n Median :-0.2598   Median :-0.3871   Median : 0.2595   Median :-0.3384  \n Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.: 0.4456   3rd Qu.: 0.7155   3rd Qu.: 0.8714   3rd Qu.: 0.8199  \n Max.   : 2.9143   Max.   : 2.2280   Max.   : 1.3610   Max.   : 2.3810  \n       x9         \n Min.   :-1.5167  \n 1st Qu.:-0.6852  \n Median :-0.1863  \n Mean   : 0.0000  \n 3rd Qu.: 0.4235  \n Max.   : 2.0866  \n```\n:::\n\n```{.r .cell-code}\nvar(protein.Z)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            x1         x2          x3          x4          x5          x6\nx1  1.00000000  0.1530027  0.58560895  0.48457425  0.06095745 -0.49987746\nx2  0.15300271  1.0000000  0.62040916  0.27552855 -0.23400923 -0.41379691\nx3  0.58560895  0.6204092  1.00000000  0.50000926  0.06557136 -0.71243682\nx4  0.48457425  0.2755285  0.50000926  1.00000000  0.02617651 -0.44206103\nx5  0.06095745 -0.2340092  0.06557136  0.02617651  1.00000000 -0.52423080\nx6 -0.49987746 -0.4137969 -0.71243682 -0.44206103 -0.52423080  1.00000000\nx7  0.13542594  0.3137721  0.45223071  0.25540615  0.40385286 -0.53326231\nx8 -0.34944855 -0.6349618 -0.55978097 -0.50580550 -0.14715294  0.65099727\nx9 -0.07422123 -0.0613167 -0.04551755 -0.26096403  0.26613865  0.04654808\n            x7         x8          x9\nx1  0.13542594 -0.3494486 -0.07422123\nx2  0.31377205 -0.6349618 -0.06131670\nx3  0.45223071 -0.5597810 -0.04551755\nx4  0.25540615 -0.5058055 -0.26096403\nx5  0.40385286 -0.1471529  0.26613865\nx6 -0.53326231  0.6509973  0.04654808\nx7  1.00000000 -0.4743116  0.08440956\nx8 -0.47431155  1.0000000  0.37496971\nx9  0.08440956  0.3749697  1.00000000\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprotein.Z.dist <- dist(protein.Z, method=\"euclidean\")   # ② 거리행렬\n# 나중에 다양한 방법들을 적용해보기\nprotein.Z.dist\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          1        2        3        4        5        6        7        8\n2  6.123875                                                               \n3  5.941088 2.449873                                                      \n4  2.764456 4.883310 5.227110                                             \n5  5.139593 2.114980 2.213299 3.947607                                    \n6  6.610018 3.013919 2.525413 6.008027 3.340491                           \n7  6.391783 2.563414 2.102111 5.408239 1.879623 2.721124                  \n8  5.814582 4.042713 3.457791 5.748819 3.913776 2.615699 3.994256         \n9  6.296012 3.588910 2.193291 5.546748 3.360107 3.657722 3.781843 4.567955\n10 4.244946 5.163303 4.695152 3.748492 4.866844 5.590841 5.614962 5.474533\n11 4.673363 3.266150 3.985273 3.345019 2.749570 5.010346 3.675953 5.328549\n12 6.730999 2.732974 1.630907 6.182109 3.122919 2.829417 2.989315 3.224120\n13 4.022035 3.711167 3.716300 2.859180 3.345898 4.762895 4.319464 4.864586\n14 5.986448 1.116565 2.239399 5.141308 2.160153 2.535976 2.494697 3.365080\n15 5.441777 3.873663 2.953678 5.250463 3.506576 1.992772 3.244186 2.030075\n16 5.871454 2.795918 2.935223 4.417656 2.090846 3.839478 2.693562 4.097647\n17 6.610517 6.507879 5.633919 6.003440 5.512520 5.827369 5.248118 6.428604\n18 2.688487 4.640216 4.755043 1.886874 3.561895 5.512335 4.784174 5.004229\n19 5.568338 4.871951 3.985465 4.841928 4.146923 5.079414 4.086358 5.409697\n20 5.229438 3.529912 2.949649 4.903076 2.965132 3.092112 2.542194 4.275745\n21 5.096917 2.198411 2.333797 4.449617 2.593398 3.187969 3.543233 3.520186\n22 5.926153 3.747707 1.942979 5.779938 3.820355 3.471573 3.913917 3.855547\n23 4.336891 4.160985 3.160461 3.819771 2.712791 4.151407 3.411440 3.417115\n24 6.345178 1.643941 1.417223 5.598788 2.172661 2.382298 1.872404 3.615881\n25 2.942274 5.433204 5.596744 1.992518 4.339328 6.338870 5.524645 5.732427\n          9       10       11       12       13       14       15       16\n2                                                                         \n3                                                                         \n4                                                                         \n5                                                                         \n6                                                                         \n7                                                                         \n8                                                                         \n9                                                                         \n10 4.544557                                                               \n11 4.962783 4.100647                                                      \n12 3.143931 5.697292 4.784389                                             \n13 3.796687 2.145756 3.150281 4.825175                                    \n14 3.405382 5.152024 3.457789 2.342517 3.905212                           \n15 3.918233 4.623274 4.884784 3.608666 3.985673 3.363363                  \n16 3.598806 4.413737 3.023794 3.730426 3.111997 2.769121 3.704275         \n17 5.632730 4.762834 5.695401 7.025402 4.651763 6.336455 4.752560 4.788692\n18 5.518264 3.612688 2.470722 5.580929 3.108077 4.622070 4.663587 3.943882\n19 4.433606 3.082462 3.880044 5.248204 2.868401 4.838410 4.129411 3.377436\n20 4.254842 5.190977 4.215675 4.049561 4.026921 3.497706 2.940822 4.259157\n21 2.420056 4.101138 3.821847 2.815059 2.915464 1.901042 3.337777 3.069445\n22 2.570958 4.620733 5.104963 2.246291 4.178481 3.515752 3.548623 4.499316\n23 4.235938 4.114133 3.421339 3.884740 3.558105 3.874407 3.251411 2.915581\n24 2.935469 5.363661 3.889344 1.790710 4.133378 1.262664 3.295288 2.996946\n25 6.296222 3.920355 3.030617 6.436280 3.577969 5.481283 5.386559 4.477836\n         17       18       19       20       21       22       23       24\n2                                                                         \n3                                                                         \n4                                                                         \n5                                                                         \n6                                                                         \n7                                                                         \n8                                                                         \n9                                                                         \n10                                                                        \n11                                                                        \n12                                                                        \n13                                                                        \n14                                                                        \n15                                                                        \n16                                                                        \n17                                                                        \n18 5.625717                                                               \n19 2.929892 4.241617                                                      \n20 5.165496 4.550891 4.274958                                             \n21 6.086275 4.336272 4.548833 3.740528                                    \n22 6.514669 5.413308 4.695146 3.765195 2.839136                           \n23 5.058469 2.749723 3.616797 3.942925 3.786530 4.003052                  \n24 6.122876 5.083416 4.589144 3.016613 2.278316 2.894140 3.894353         \n25 5.823758 0.984629 4.566993 5.325980 5.185324 6.254361 3.345415 5.954889\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 계층적 군집분석 - hierarchical\nprotein.Z.hclust <- hclust(protein.Z.dist, method=\"ward.D\")   # ③ 군집분석single\n# 연결 방식에 대한 옵션 해보기\nprotein.Z.hclust\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nhclust(d = protein.Z.dist, method = \"ward.D\")\n\nCluster method   : ward.D \nDistance         : euclidean \nNumber of objects: 25 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(protein.Z.hclust,labels=protein$country)   # ④ 덴드로그램\n```\n\n::: {.cell-output-display}\n![](1205_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(protein.Z.hclust,labels=protein$country, hang=-1)   # ④ 덴드로그램 (밑에서 맞추기)\n```\n\n::: {.cell-output-display}\n![](1205_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(protein.Z.hclust,labels=protein$country, hang=-1, cex=0.4)   # ④ 덴드로그램(변수글자크기)\n\nrect.hclust(protein.Z.hclust,k=3,border=\"red\")   # ⑤ 군집 구분\n```\n\n::: {.cell-output-display}\n![](1205_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 참고사항1\n#install.packages(\"cluster\")\nlibrary(\"cluster\")\nplot(silhouette(cutree(protein.Z.hclust,k=3),dist=dist(protein.Z),col=1:5))\n```\n\n::: {.cell-output-display}\n![](1205_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"fpc\")\nlibrary(\"fpc\")\n\nclust <- numeric(20)\nfor(k in 2:20){\n  clust[[k]] <- pam(protein.Z, k) $ silinfo $ avg.width # s_data대신 데이터변수만 넣어줍시다.\n  k.best <- which.max(clust)}\ncat(\"최적의 실루엣 값을 갖는 클러스터 개수는:\", k.best, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n최적의 실루엣 값을 갖는 클러스터 개수는: 3 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 참고사항2\n#install.packages(\"corrplot\")\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\ncorrplot 0.92 loaded\n```\n:::\n\n```{.r .cell-code}\nM <- cor(protein.Z) \n#M\n#corrplot(M, method=\"circle\")\n#corrplot(M, method=\"ellipse\")\ncorrplot(M, method=\"number\")\n```\n\n::: {.cell-output-display}\n![](1205_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 예 7.2\nhcluster <- cutree(protein.Z.hclust,k=5)\nhcluster  # 25개의 자료에 해당하는 군집\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 1 2 2 1 3 4 3 4 2 5 3 2 5 2 4 3 5 1 5 4 2 2 3 2 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprotein.X.hclust <- data.frame(protein,hcluster)\nhead(protein.X.hclust,n=10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          country   x1   x2  x3   x4  x5   x6  x7  x8  x9 hcluster\n1         Albania 10.1  1.4 0.5  8.9 0.2 42.3 0.6 5.5 1.7        1\n2         Austria  8.9 14.0 4.3 19.9 2.1 28.0 3.6 1.3 4.3        2\n3         Belgium 13.5  9.3 4.1 17.5 4.5 26.6 5.7 2.1 4.0        2\n4        Bulgaria  7.8  6.0 1.6  8.3 1.2 56.7 1.1 3.7 4.2        1\n5  Czechoslovakia  9.7 11.4 2.8 12.5 2.0 34.3 5.0 1.1 4.0        3\n6         Denmark 10.6 10.8 3.7 25.0 9.9 21.9 4.8 0.7 2.4        4\n7       E Germany  8.4 11.6 3.7 11.1 5.4 24.6 6.5 0.8 3.6        3\n8         Finland  9.5  4.9 2.7 33.7 5.8 26.3 5.1 1.0 1.4        4\n9          France 18.0  9.9 3.3 19.5 5.7 28.1 4.8 2.4 6.5        2\n10         Greece 10.2  3.0 2.8 17.6 5.9 41.7 2.2 7.8 6.5        5\n```\n:::\n\n```{.r .cell-code}\nprotein.X.hclust\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          country   x1   x2  x3   x4   x5   x6  x7  x8  x9 hcluster\n1         Albania 10.1  1.4 0.5  8.9  0.2 42.3 0.6 5.5 1.7        1\n2         Austria  8.9 14.0 4.3 19.9  2.1 28.0 3.6 1.3 4.3        2\n3         Belgium 13.5  9.3 4.1 17.5  4.5 26.6 5.7 2.1 4.0        2\n4        Bulgaria  7.8  6.0 1.6  8.3  1.2 56.7 1.1 3.7 4.2        1\n5  Czechoslovakia  9.7 11.4 2.8 12.5  2.0 34.3 5.0 1.1 4.0        3\n6         Denmark 10.6 10.8 3.7 25.0  9.9 21.9 4.8 0.7 2.4        4\n7       E Germany  8.4 11.6 3.7 11.1  5.4 24.6 6.5 0.8 3.6        3\n8         Finland  9.5  4.9 2.7 33.7  5.8 26.3 5.1 1.0 1.4        4\n9          France 18.0  9.9 3.3 19.5  5.7 28.1 4.8 2.4 6.5        2\n10         Greece 10.2  3.0 2.8 17.6  5.9 41.7 2.2 7.8 6.5        5\n11        Hungary  5.3 12.4 2.9  9.7  0.3 40.1 4.0 5.4 4.2        3\n12        Ireland 13.9 10.0 4.7 25.8  2.2 24.0 6.2 1.6 2.9        2\n13          Italy  9.0  5.1 2.9 13.7  3.4 36.8 2.1 4.3 6.7        5\n14    Netherlands  9.5 13.6 3.6 23.4  2.5 22.4 4.2 1.8 3.7        2\n15         Norway  9.4  4.7 2.7 23.3  9.7 23.0 4.6 1.6 2.7        4\n16         Poland  6.9 10.2 2.7 19.3  3.0 36.1 5.9 2.0 6.6        3\n17       Portugal  6.2  3.7 1.1  4.9 14.2 27.0 5.9 4.7 7.9        5\n18        Romania  6.2  6.3 1.5 11.1  1.0 49.6 3.1 5.3 2.8        1\n19          Spain  7.1  3.4 3.1  8.6  7.0 29.2 5.7 5.9 7.2        5\n20         Sweden  9.9  7.8 3.5  4.7  7.5 19.5 3.7 1.4 2.0        4\n21    Switzerland 13.1 10.1 3.1 23.8  2.3 25.6 2.8 2.4 4.9        2\n22             UK 17.4  5.7 4.7 20.6  4.3 24.3 4.7 3.4 3.3        2\n23           USSR  9.3  4.6 2.1 16.6  3.0 43.6 6.4 3.4 2.9        3\n24      W Germany 11.4 12.5 4.1 18.8  3.4 18.6 5.2 1.5 3.8        2\n25     Yugoslavia  4.4  5.0 1.2  9.5  0.6 55.9 3.0 5.7 3.2        1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 자료화하여 정리 \nwrite.csv(protein.X.hclust,\"protein_X_hclust.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 예 7.3\ntable(hcluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhcluster\n1 2 3 4 5 \n4 8 5 4 4 \n```\n:::\n\n```{.r .cell-code}\n# 각 군집에 포함되는 케이스의 수\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\naggregate(protein.Z,by=list(hcluster),FUN=mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Group.1           x1         x2          x3         x4         x5         x6\n1       1 -0.807569986 -0.8719354 -1.55330561 -0.9351841 -1.0386379  1.7200335\n2       2  1.011180399  0.7421332  0.94084150  0.6610479 -0.2671539 -0.6877583\n3       3 -0.570049402  0.5803879 -0.08589708 -0.3368952 -0.4537795  0.3181839\n4       4  0.006572897 -0.2290150  0.19147892  0.7308937  1.1582546 -0.8722721\n5       5 -0.508801956 -1.1088009 -0.41248496 -0.6966863  0.9819154  0.1300253\n          x7         x8          x9\n1 -1.4234267  0.9961313 -0.64360439\n2  0.2288743 -0.5083895  0.02161979\n3  0.7857609 -0.2679180  0.06873983\n4  0.1676780 -0.9553392 -1.11480485\n5 -0.1842010  1.3108846  1.62924487\n```\n:::\n\n```{.r .cell-code}\naggregate(protein[-1],by=list(hcluster),FUN=mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Group.1      x1      x2     x3      x4    x5     x6    x7     x8    x9\n1       1  7.1250  4.6750 1.2000  9.4500 0.750 51.125 1.950 5.0500 2.975\n2       2 13.2125 10.6375 3.9875 21.1625 3.375 24.700 4.650 2.0625 4.175\n3       3  7.9200 10.0400 2.8400 13.8400 2.740 35.740 5.560 2.5400 4.260\n4       4  9.8500  7.0500 3.1500 21.6750 8.225 22.675 4.550 1.1750 2.125\n5       5  8.1250  3.8000 2.4750 11.2000 7.625 33.675 3.975 5.6750 7.075\n```\n:::\n\n```{.r .cell-code}\n# 특성 파악 - 정답이 없음\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprotein.Z.hclust <- data.frame(protein.Z,hcluster)\nprotein.Z.hclust\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            x1          x2          x3          x4           x5         x6\n1   0.08126490 -1.75848885 -2.17963852 -1.01014056 -1.200282130  0.9159176\n2  -0.27725673  1.65237315  1.22045441  0.48898871 -0.641874675 -0.3870690\n3   1.09707621  0.38006748  1.04150215  0.16190596  0.063482111 -0.5146342\n4  -0.60590157 -0.51325352 -1.19540109 -1.09191125 -0.906383469  2.2280161\n5  -0.03824231  0.94854448 -0.12168754 -0.51951643 -0.671264541  0.1869740\n6   0.23064892  0.78612248  0.68359763  1.18403956  1.650534878 -0.9428885\n7  -0.42664075  1.00268515  0.68359763 -0.71031471  0.327990905 -0.6968701\n8  -0.09799591 -0.81102719 -0.21116367  2.36971452  0.445550369 -0.5419696\n9   2.44153235  0.54248948  0.32569311  0.43447492  0.416160503 -0.3779572\n10  0.11114171 -1.32536352 -0.12168754  0.17553441  0.474940235  0.8612468\n11 -1.35282164  1.21924781 -0.03221141 -0.90111298 -1.170892264  0.7154581\n12  1.21658342  0.56955981  1.57835893  1.29306714 -0.612484809 -0.7515408\n13 -0.24737993 -0.75688652 -0.03221141 -0.35597506 -0.259806416  0.4147689\n14 -0.09799591  1.54409181  0.59412150  0.96598439 -0.524315210 -0.8973295\n15 -0.12787272 -0.86516785 -0.21116367  0.95235594  1.591755146 -0.8426588\n16 -0.87479279  0.62370048 -0.21116367  0.40721802 -0.377365880  0.3509863\n17 -1.08393041 -1.13587119 -1.64278174 -1.55527848  2.914299118 -0.4781870\n18 -1.08393041 -0.43204252 -1.28487722 -0.71031471 -0.965163201  1.5810786\n19 -0.81503919 -1.21708219  0.14674085 -1.05102590  0.798228762 -0.2777275\n20  0.02151130 -0.02598752  0.50464537 -1.58253537  0.945178092 -1.1615716\n21  0.97756900  0.59663015  0.14674085  1.02049818 -0.583094943 -0.6057521\n22  2.26227153 -0.59446452  1.57835893  0.58438785  0.004702379 -0.7242054\n23 -0.15774952 -0.89223819 -0.74802044  0.03924993 -0.377365880  1.0343709\n24  0.46966334  1.24631815  1.04150215  0.33907578 -0.259806416 -1.2435778\n25 -1.62171287 -0.78395685 -1.55330561 -0.92836987 -1.082722666  2.1551217\n            x7         x8          x9 hcluster\n1  -2.24957717  1.2227536 -1.35040507        1\n2  -0.41368721 -0.8923886  0.09091397        2\n3   0.87143577 -0.4895043 -0.07539207        2\n4  -1.94359551  0.3162641  0.03547862        1\n5   0.44306145 -0.9931096 -0.07539207        3\n6   0.32066878 -1.1945517 -0.96235764        4\n7   1.36100643 -1.1441912 -0.29713346        3\n8   0.50425778 -1.0434702 -1.51671112        4\n9   0.32066878 -0.3384228  1.31049162        2\n10 -1.27043586  2.3810458  1.31049162        5\n11 -0.16890188  1.1723931  0.03547862        3\n12  1.17741743 -0.7413070 -0.68518090        2\n13 -1.33163219  0.6184273  1.42136232        5\n14 -0.04650921 -0.6405859 -0.24169812        2\n15  0.19827612 -0.7413070 -0.79605159        4\n16  0.99382843 -0.5398649  1.36592697        3\n17  0.99382843  0.8198694  2.08658649        5\n18 -0.71966887  1.1220326 -0.74061625        1\n19  0.87143577  1.4241958  1.69853906        5\n20 -0.35249087 -0.8420280 -1.18409903        4\n21 -0.90325786 -0.3384228  0.42352606        2\n22  0.25947245  0.1651825 -0.46343951        2\n23  1.29981010  0.1651825 -0.68518090        3\n24  0.56545411 -0.7916675 -0.18626277        2\n25 -0.78086520  1.3234747 -0.51887486        1\n```\n:::\n\n```{.r .cell-code}\naggregate(cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)~hcluster,data=protein.Z.hclust,mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  hcluster           x1         x2          x3         x4         x5         x6\n1        1 -0.807569986 -0.8719354 -1.55330561 -0.9351841 -1.0386379  1.7200335\n2        2  1.011180399  0.7421332  0.94084150  0.6610479 -0.2671539 -0.6877583\n3        3 -0.570049402  0.5803879 -0.08589708 -0.3368952 -0.4537795  0.3181839\n4        4  0.006572897 -0.2290150  0.19147892  0.7308937  1.1582546 -0.8722721\n5        5 -0.508801956 -1.1088009 -0.41248496 -0.6966863  0.9819154  0.1300253\n          x7         x8          x9\n1 -1.4234267  0.9961313 -0.64360439\n2  0.2288743 -0.5083895  0.02161979\n3  0.7857609 -0.2679180  0.06873983\n4  0.1676780 -0.9553392 -1.11480485\n5 -0.1842010  1.3108846  1.62924487\n```\n:::\n:::\n",
    "supporting": [
      "1205_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}