{
  "hash": "8e5420cdc1cee942870cf197c60a4628",
  "result": {
    "markdown": "---\ntitle: \"02_회귀분석\"\ndate: \"2023/10/10\"\nauthor: \"Sungil Park\"\ndescription: \"2023-2학기 R로 하는 금융데이터분석\"\n---\n\n\n\n\n## 실습 데이터\n\n실습 데이터는 2020~2022년의 월별 대인 손해액이다.<br>월별 대인 손해액을 회귀분석 한다.\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-1d2911135d4d513791db\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1d2911135d4d513791db\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],[\"2020.01\",\"2020.02\",\"2020.03\",\"2020.04\",\"2020.05\",\"2020.06\",\"2020.07\",\"2020.08\",\"2020.09\",\"2020.10\",\"2020.11\",\"2020.12\",\"2021.01\",\"2021.02\",\"2021.03\",\"2021.04\",\"2021.05\",\"2021.06\",\"2021.07\",\"2021.08\",\"2021.09\",\"2021.10\",\"2021.11\",\"2021.12\",\"2022.01\",\"2022.02\",\"2022.03\",\"2022.04\",\"2022.05\",\"2022.06\",\"2022.07\",\"2022.08\",\"2022.09\",\"2022.10\",\"2022.11\",\"2022.12\"],[5238500,4775400,5916100,7929800,8008500,6293300,4182700,4118900,6592500,8618600,8767400,7748900,6511500,5523400,7364600,8607400,9470900,7742000,5285500,5240300,8001100,10318600,10330500,8428700,6550000,5592500,7171100,11005000,8824600,8025300,5223500,4723100,8074400,11198700,11798500,8723200]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>t<\\/th>\\n      <th>yymm<\\/th>\\n      <th>market<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## 선형회귀모형\n\n#### formula\n\n$$ y = b_0 + b_1x$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(market ~ t, data = data)\nmodel %>% summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = market ~ t, data = data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3859553 -1315301   -70334  1707873  2962448 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  5879738     634908   9.261 8.03e-11 ***\nt              84466      29924   2.823   0.0079 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1865000 on 34 degrees of freedom\nMultiple R-squared:  0.1898,\tAdjusted R-squared:  0.166 \nF-statistic: 7.967 on 1 and 34 DF,  p-value: 0.007902\n```\n:::\n:::\n\n\n$$b_0 = 5879738$$\n\n$$b_1 = 84666$$\n\n### 회귀식\n\n$$y = 5879738 + 84666x$$\n\np-value 가 0.007902로 0.05보다 작으므로 유의하다고 볼 수 있다.\n\nR-squared 값이 0.1898로 설명력이 낮다고 볼 수 있다.\n\n## 시각화\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x=t, y=market)) +\n  geom_point() +\n  geom_smooth(method='lm', se=FALSE)+\n  labs(title = \"Linear Regression of market ~ t\", subtitle = \"y = 5879738 + 84466 * t\")+\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](1010_Regression_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## 예측\n\n- 2023년의 월별손해액 예측\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_regression <- function(t) {\n  y <- 5879738 + 84466 * t\n  return(y)\n}\n\npred_t <- c(37:48)\npred_yymm <- c(\"2023.01\",\"2023.02\",\"2023.03\",\"2023.04\",\"2023.05\",\"2023.06\",\"2023.07\",\"2023.08\",\"2023.09\",\"2023.10\",\"2023.11\",\"2023.12\")\npred_market <- linear_regression(pred_t)\n\ndata.frame(pred_t,pred_yymm,pred_market)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   pred_t pred_yymm pred_market\n1      37   2023.01     9004980\n2      38   2023.02     9089446\n3      39   2023.03     9173912\n4      40   2023.04     9258378\n5      41   2023.05     9342844\n6      42   2023.06     9427310\n7      43   2023.07     9511776\n8      44   2023.08     9596242\n9      45   2023.09     9680708\n10     46   2023.10     9765174\n11     47   2023.11     9849640\n12     48   2023.12     9934106\n```\n:::\n:::\n",
    "supporting": [
      "1010_Regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.3/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.30/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}