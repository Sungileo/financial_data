{
  "hash": "0aff0241e388f8a2c5fac0824df7d632",
  "result": {
    "markdown": "---\ntitle: \"분기별 선형모형\"\ndate: \"2023/10/26\"\nauthor: \"Sungil Park\"\ndescription: \"2023-2학기 R로 하는 금융데이터분석\"\n---\n\n\n\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_bin <- readxl::read_xlsx(\"contents/2. 예측수준의 결정.xlsx\",sheet = 2)\ndata_sim <- readxl::read_xlsx(\"contents/2. 예측수준의 결정.xlsx\",sheet = 3)\n\ndata_bin %>% head() %>% kable()\n```\n\n::: {.cell-output-display}\n|  t| year| quat| in1_bin| mul_bin| jas_bin| cha_bin|\n|--:|----:|----:|-------:|-------:|-------:|-------:|\n|  1| 2016|    1|    5.71|    8.42|    0.95|   15.84|\n|  2| 2016|    2|    6.16|    8.20|    0.75|   14.61|\n|  3| 2016|    3|    6.54|    8.73|    0.78|   15.37|\n|  4| 2016|    4|    6.64|    9.01|    0.87|   15.39|\n|  5| 2017|    1|    5.88|    9.06|    1.05|   16.68|\n|  6| 2017|    2|    6.02|    8.41|    0.61|   13.98|\n:::\n:::\n\n\n\n\n## 분기별 선형모형\n\n### in1_bin\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_bin %>% ggplot(aes(x=t, y=in1_bin, color = factor(quat)))+\n  geom_point()+\n  geom_smooth(data = data_bin,aes(x=t,y=in1_bin,color = factor(quat)),method = \"lm\",se=FALSE)+\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](1031__files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n#### 1분기\n\n$$\ny = 5.58161 + 0.08196 * t\n$$\n\n-   R-squared :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8613146\n```\n:::\n:::\n\n\n-   adj R-squared :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8335775\n```\n:::\n:::\n\n\n-   p-value :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.002563184\n```\n:::\n:::\n\n\n#### 2분기\n\n$$\ny = 5.69036 + 0.08661 * t\n$$\n\n-   R-squared :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8707973\n```\n:::\n:::\n\n\n-   adj R-squared :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8449568\n```\n:::\n:::\n\n\n-   p-value :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.002139097\n```\n:::\n:::\n\n\n#### 3분기\n\n$$\ny = 5.98027 + 0.09741 * t\n$$\n\n-   R-squared :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.942346\n```\n:::\n:::\n\n\n-   adj R-squared :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9308152\n```\n:::\n:::\n\n\n-   p-value :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0002767648\n```\n:::\n:::\n\n\n#### 4분기\n\n$$\ny = 6.02714 + 0.9991 * t\n$$\n\n-   R-squared :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8682876\n```\n:::\n:::\n\n\n-   adj R-squared :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8419451\n```\n:::\n:::\n\n\n-   p-value :\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.002246747\n```\n:::\n:::\n\n\n## 1031\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfilter(data_bin,quat == 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 7\n      t  year  quat in1_bin mul_bin jas_bin cha_bin\n  <dbl> <dbl> <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1     1  2016     1    5.71    8.42    0.95    15.8\n2     5  2017     1    5.88    9.06    1.05    16.7\n3     9  2018     1    6.06    9.33    0.76    16.3\n4    13  2019     1    6.82   10.7     0.97    20.2\n5    17  2020     1    7.51   11.3     0.9     19.1\n6    21  2021     1    7.03   10.7     0.8     17.8\n7    25  2022     1    7.52   11.5     0.89    19  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_1 <- lm(in1_bin ~ t + factor(quat), data = data_bin)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#model_1 %>% summary()\n\nmodel_1_pred <- function(x, q) {\n  if (q == 1) {\n    return(model_1$coefficients[1] + model_1$coefficients[2] * x)\n  } else if (q == 2) {\n    return(model_1$coefficients[1] + model_1$coefficients[2] * x + model_1$coefficients[3])\n  } else if (q == 3) {\n    return(model_1$coefficients[1] + model_1$coefficients[2] * x + model_1$coefficients[4])\n  } else if (q == 4) {\n    return(model_1$coefficients[1] + model_1$coefficients[2] * x + model_1$coefficients[5])\n  } else {\n    return(NA)\n  }\n}\n\nd2 <- data.frame(t = seq(29,32),quat = seq(1,4))\n\nd2$in1_bin_pred <- mapply(model_1_pred, d2$t, d2$quat)\n\nd2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   t quat in1_bin_pred\n1 29    1     8.110714\n2 30    2     8.366429\n3 31    3     8.905000\n4 32    4     9.089286\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_bin\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 28 × 7\n       t  year  quat in1_bin mul_bin jas_bin cha_bin\n   <dbl> <dbl> <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n 1     1  2016     1    5.71    8.42    0.95    15.8\n 2     2  2016     2    6.16    8.2     0.75    14.6\n 3     3  2016     3    6.54    8.73    0.78    15.4\n 4     4  2016     4    6.64    9.01    0.87    15.4\n 5     5  2017     1    5.88    9.06    1.05    16.7\n 6     6  2017     2    6.02    8.41    0.61    14.0\n 7     7  2017     3    6.61    9.41    0.64    16.2\n 8     8  2017     4    6.64   10.0     0.75    16.8\n 9     9  2018     1    6.06    9.33    0.76    16.3\n10    10  2018     2    6.2     9.24    0.62    16.2\n# ℹ 18 more rows\n```\n:::\n\n```{.r .cell-code}\ndata_bin$in1bin_pred <- mapply(model_1_pred,data_bin$t,data_bin$quat)\n\ndata_bin %>% ggplot()+\n  geom_line(aes(t,in1bin_pred,color = factor(quat)))+\n#  geom_point(aes(t,in1bin_pred,color = factor(quat)))+\n  geom_point(aes(t,in1_bin, color = factor(quat)))\n```\n\n::: {.cell-output-display}\n![](1031__files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- model_1$coefficients[1] + model_1$coefficients[2]*5\n\nmodel_1$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  (Intercept)             t factor(quat)2 factor(quat)3 factor(quat)4 \n   5.45799107    0.09147321    0.16424107    0.61133929    0.70415179 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd1 <- filter(data_bin,quat == 1)\nplot(d1$t,d1$in1_bin)\n```\n\n::: {.cell-output-display}\n![](1031__files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n66000*1.1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 72600\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n1.1*0.9\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.99\n```\n:::\n:::\n",
    "supporting": [
      "1031__files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}