{
  "hash": "d599674b1468001021519d640ed93014",
  "result": {
    "markdown": "---\ntitle: \"_\"\ndate: \"2023/11/16\"\nauthor: \"Sungil Park\"\ndescription: \"2023-2학기 R로 하는 금융데이터분석\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproject_data <- read.csv(\"contents/프로젝트자료.csv\")\n\nproject_data <- project_data %>%  \n  mutate(\n    GAI_COD = factor(GAI_COD),\n    차종 = as.factor(case_when(\n      car_knd %in% c(\"1A\", \"1E\") ~ \"소형\",\n      car_knd %in% c(\"1F\", \"1G\", \"1H\") ~ \"준중형\",\n      car_knd %in% c(\"1L\", \"1M\", \"1N\") ~ \"중형\",\n      car_knd %in% c(\"1P\", \"29\") ~ \"대형\",\n      TRUE ~ \"SUB/VAN\")))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmyfunc_1 <- function(df,y) {\n  in1_bin <- sum(df$in1_los != 0) / nrow(df)\n  mul_bin <- sum(df$mul_los != 0) / nrow(df)\n  jas_bin <- sum(df$jas_los != 0) / nrow(df)\n  cha_bin <- sum(df$cha_los != 0) / nrow(df)\n\n  in1_dep <- sum(df$in1_los) / sum(df$in1_los != 0)\n  mul_dep <- sum(df$mul_los) / sum(df$mul_los != 0)\n  jas_dep <- sum(df$jas_los) / sum(df$jas_los != 0)\n  cha_dep <- sum(df$cha_los) / sum(df$cha_los != 0)\n  \n  in1_sun <- in1_bin*in1_dep\n  mul_sun <- mul_bin*mul_dep\n  jas_sun <- jas_bin*jas_dep\n  cha_sun <- cha_bin*cha_dep\n  \n  result_df <- data.frame(value = c(in1_bin, mul_bin, jas_bin, cha_bin, in1_dep, mul_dep, jas_dep, cha_dep,in1_sun, mul_sun, jas_sun, cha_sun) %>% as.character())\n  rownames(result_df) <- c(\"대인빈도\",\"대물빈도\",\"자손빈도\",\"자차빈도\",\"대인심도\",\"대물심도\",\"자손심도\",\"자차심도\",\"대인순보\",\"대물순보\",\"자손순보\",\"자차순보\")\n  colnames(result_df) <- y\n  return(result_df)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd_2 <- cbind(\n  myfunc_1(project_data %>% filter(PIB_SEX==1),\"PIB_SEX_1\"),\n  myfunc_1(project_data %>% filter(PIB_SEX==2),\"PIB_SEX_2\"),\n  myfunc_1(project_data %>% filter(GAI_COD==1),\"GAI_COD_1\"),\n  myfunc_1(project_data %>% filter(GAI_COD==2),\"GAI_COD_2\"),\n  myfunc_1(project_data %>% filter(GAI_COD==3),\"GAI_COD_3\"),\n  myfunc_1(project_data %>% filter(GAI_COD==4),\"GAI_COD_4\"),\n  myfunc_1(project_data %>% filter(GAI_COD==5),\"GAI_COD_5\"),\n  myfunc_1(project_data %>% filter(GAI_COD==6),\"GAI_COD_6\"),\n  myfunc_1(project_data %>% filter(GAI_COD==7),\"GAI_COD_7\"),\n  myfunc_1(project_data %>% filter(GAI_COD==8),\"GAI_COD_8\"),\n  myfunc_1(project_data %>% filter(차종==\"소형\"),\"차종_소형\"),\n  myfunc_1(project_data %>% filter(차종==\"중형\"),\"차종_중형\"),\n  myfunc_1(project_data %>% filter(차종==\"준중형\"),\"차종_준중형\"),\n  myfunc_1(project_data %>% filter(차종==\"대형\"),\"차종_대형\"),\n  myfunc_1(project_data %>% filter(차종==\"SUB/VAN\"),\"차종_SUB/VAN\")\n  )\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-50ba9507a9e8f9db4c38\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-50ba9507a9e8f9db4c38\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"대인빈도\",\"대물빈도\",\"자손빈도\",\"자차빈도\",\"대인심도\",\"대물심도\",\"자손심도\",\"자차심도\",\"대인순보\",\"대물순보\",\"자손순보\",\"자차순보\"],[\"0.0217198581560284\",\"0.061613475177305\",\"0.00620567375886525\",\"0.273492907801418\",\"5366818.97959184\",\"1222076.76258993\",\"1081013.57142857\",\"908856.499189627\",\"116566.546985816\",\"75296.3962765957\",\"6708.41755319149\",\"248565.806737589\"],[\"0.0205607476635514\",\"0.0672897196261682\",\"0.00186915887850467\",\"0.327102803738318\",\"1440490\",\"1520054.72222222\",\"367710\",\"910042.8\",\"29617.5514018692\",\"102284.056074766\",\"687.308411214953\",\"297677.551401869\"],[\"0\",\"0.166666666666667\",\"0\",\"0.833333333333333\",\"NaN\",\"237200\",\"NaN\",\"212094\",\"NaN\",\"39533.3333333333\",\"NaN\",\"176745\"],[\"0.0153846153846154\",\"0.0307692307692308\",\"0.0153846153846154\",\"0.307692307692308\",\"5402840\",\"1221185\",\"1417210\",\"1155746\",\"83120.6153846154\",\"37574.9230769231\",\"21803.2307692308\",\"355614.153846154\"],[\"0.0576923076923077\",\"0.115384615384615\",\"0\",\"0.269230769230769\",\"1046553.33333333\",\"1183188.33333333\",\"NaN\",\"3108533.57142857\",\"60378.0769230769\",\"136521.730769231\",\"NaN\",\"836912.884615385\"],[\"0\",\"0.0549450549450549\",\"0\",\"0.32967032967033\",\"NaN\",\"2090452\",\"NaN\",\"862883.666666667\",\"NaN\",\"114860\",\"NaN\",\"284467.142857143\"],[\"0.0307692307692308\",\"0.0769230769230769\",\"0\",\"0.4\",\"1152670\",\"2191802\",\"NaN\",\"740793.461538462\",\"35466.7692307692\",\"168600.153846154\",\"NaN\",\"296317.384615385\"],[\"0.0135135135135135\",\"0.027027027027027\",\"0\",\"0.22972972972973\",\"140110\",\"3727500\",\"NaN\",\"610847.058823529\",\"1893.37837837838\",\"100743.243243243\",\"NaN\",\"140329.72972973\"],[\"0.0375\",\"0.05\",\"0\",\"0.3375\",\"1898740\",\"1210480\",\"NaN\",\"2115336.2962963\",\"71202.75\",\"60524\",\"NaN\",\"713926\"],[\"0.0216010165184244\",\"0.0635324015247776\",\"0.00592969080897925\",\"0.277424819991529\",\"5145607.25490196\",\"1207358.33333333\",\"1006049.28571429\",\"827349.572519084\",\"111150.347310462\",\"76706.3744176196\",\"5965.56120288014\",\"229527.306226175\"],[\"0.032967032967033\",\"0.043956043956044\",\"0\",\"0.181318681318681\",\"1340416.66666667\",\"819775\",\"NaN\",\"775281.818181818\",\"44189.5604395604\",\"36034.0659340659\",\"NaN\",\"140573.076923077\"],[\"0.0249520153550864\",\"0.072936660268714\",\"0.00383877159309021\",\"0.374280230326296\",\"1606591.53846154\",\"1051098.15789474\",\"646645\",\"1448345.12820513\",\"40087.6967370441\",\"76663.5892514395\",\"2482.32245681382\",\"542086.948176584\"],[\"0.0192043895747599\",\"0.0576131687242798\",\"0.0109739368998628\",\"0.246913580246914\",\"7131054.28571429\",\"1048251.19047619\",\"726227.5\",\"715129.388888889\",\"136947.544581619\",\"60393.072702332\",\"7969.57475994513\",\"176575.157750343\"],[\"0.0184940554821664\",\"0.0607661822985469\",\"0.00396301188903567\",\"0.28005284015852\",\"1674342.85714286\",\"1301056.08695652\",\"1680150\",\"787413.820754717\",\"30965.3896961691\",\"79060.2113606341\",\"6658.45442536328\",\"220517.476882431\"],[\"0.0231404958677686\",\"0.0677685950413223\",\"0.00330578512396694\",\"0.287603305785124\",\"9064742.14285714\",\"1810136.09756098\",\"1679170\",\"681539.252873563\",\"209762.628099174\",\"122670.380165289\",\"5550.97520661157\",\"196012.94214876\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>PIB_SEX_1<\\/th>\\n      <th>PIB_SEX_2<\\/th>\\n      <th>GAI_COD_1<\\/th>\\n      <th>GAI_COD_2<\\/th>\\n      <th>GAI_COD_3<\\/th>\\n      <th>GAI_COD_4<\\/th>\\n      <th>GAI_COD_5<\\/th>\\n      <th>GAI_COD_6<\\/th>\\n      <th>GAI_COD_7<\\/th>\\n      <th>GAI_COD_8<\\/th>\\n      <th>차종_소형<\\/th>\\n      <th>차종_중형<\\/th>\\n      <th>차종_준중형<\\/th>\\n      <th>차종_대형<\\/th>\\n      <th>차종_SUB/VAN<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.30/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}